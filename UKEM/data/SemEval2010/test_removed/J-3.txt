budget optimization in search-based advertising 
auctions 
jon feldman 
google inc 
new york ny 
jonfeld google com 
s muthukrishnan 
google inc 
new york ny 
muthu google com 
martin p´al 
google inc 
new york ny 
mpal google com 
cliff stein 
 
department of ieor 
columbia university 
cliff ieor columbia edu 
abstract 
internet search companies sell advertisement slots based on 
users search queries via an auction while there has been 
previous work on the auction process and its game-theoretic 
aspects most of it focuses on the internet company in this 
work we focus on the advertisers who must solve a complex 
optimization problem to decide how to place bids on 
keywords to maximize their return the number of user clicks on 
their ads for a given budget we model the entire process 
and study this budget optimization problem while most 
variants are np-hard we show perhaps surprisingly that 
simply randomizing between two uniform strategies that bid 
equally on all the keywords works well more precisely this 
strategy gets at least a − e fraction of the maximum 
clicks possible as our preliminary experiments show such 
uniform strategies are likely to be practical we also present 
inapproximability results and optimal algorithms for 
variants of the budget optimization problem 
categories and subject descriptors 
f theory of computation analysis of algorithms 
and problem complexity j computer applications 
social and behavioral sciences -economics 
general terms 
algorithms economics theory 
 introduction 
online search is now ubiquitous and internet search 
companies such as google yahoo and msn let companies and 
individuals advertise based on search queries posed by users 
conventional media outlets such as tv stations or 
newspapers price their ad slots individually and the advertisers 
buy the ones they can afford in contrast internet search 
companies find it difficult to set a price explicitly for the 
advertisements they place in response to user queries this 
difficulty arises because supply and demand varies widely 
and unpredictably across the user queries and they must 
price slots for billions of such queries in real time thus 
they rely on the market to determine suitable prices by 
using auctions amongst the advertisers it is a challenging 
problem to set up the auction in order to effect a stable 
market in which all the parties the advertisers users as 
well as the internet search company are adequately 
satisfied recently there has been systematic study of the issues 
involved in the game theory of the auctions revenue 
maximization etc 
the perspective in this paper is not of the internet search 
company that displays the advertisements but rather of the 
advertisers the challenge from an advertiser s point of view 
is to understand and interact with the auction mechanism 
the advertiser determines a set of keywords of their interest 
and then must create ads set the bids for each keyword 
and provide a total often daily budget when a user poses 
a search query the internet search company determines the 
advertisers whose keywords match the query and who still 
have budget left over runs an auction amongst them and 
presents the set of ads corresponding to the advertisers who 
win the auction the advertiser whose ad appears pays 
the internet search company if the user clicks on the ad 
the focus in this paper is on how the advertisers bid 
for the particular choice of keywords of their interest 
 an 
advertiser wants to optimize the overall effect of the 
advertising campaign while the effect of an ad campaign in 
any medium is a complicated phenomenon to quantify one 
commonly accepted and easily quantified notion in 
searchbased advertising on the internet is to maximize the number 
of clicks the internet search companies are supportive 
to 
the choice of keywords is related to the domain-knowledge 
of the advertiser user behavior and strategic considerations 
internet search companies provide the advertisers with 
summaries of the query traffic which is useful for them to 
optimize their keyword choices interactively we do not directly 
address the choice of keywords in this paper which is 
addressed elsewhere 
 
wards advertisers and provide statistics about the history of 
click volumes and prediction about the future performance 
of various keywords still this is a complex problem for the 
following reasons among others 
 individual keywords have significantly different 
characteristics from each other e g while fishing is a 
broad keyword that matches many user queries and 
has many competing advertisers humane fishing bait 
is a niche keyword that matches only a few queries but 
might have less competition 
 there are complex interactions between keywords 
because a user query may match two or more keywords 
since the advertiser is trying to cover all the possible 
keywords in some domain in effect the advertiser ends 
up competing with herself 
as a result the advertisers face a challenging optimization 
problem the focus of this paper is to solve this optimization 
problem 
 the budget optimization problem 
we present a short discussion and formulation of the 
optimization problem faced by advertisers a more detailed 
description is in section 
a given advertiser sees the state of the auctions for 
searchbased advertising as follows there is a set k of keywords 
of interest in practice even small advertisers typically have 
a large set k there is a set q of queries posed by the 
users for each query q ∈ q there are functions giving the 
clicksq b and costq b that result from bidding a particular 
amount b in the auction for that query which we model more 
formally in the next section there is a bipartite graph g 
on the two vertex sets representing k and q for any query 
q ∈ q the neighbors of q in k are the keywords that are 
said to match the query q 
the budget optimization problem is as follows given 
graph g together with the functions clicksq · and costq · 
on the queries as well as a budget u determine the bids 
bk for each keyword k ∈ k such that 
p 
q clicksq bq is 
maximized subject to 
p 
q costq bq ≤ u where the effective 
bid bq on a query is some function of the keyword bids in 
the neighborhood of q 
while we can cast this problem as a traditional 
optimization problem there are different challenges in practice 
depending on the advertiser s access to the query and graph 
information and indeed the reliability of this information 
 e g it could be based on unstable historical data thus 
it is important to find solutions to this problem that not 
only get many clicks but are also simple robust and less 
reliant on the information in this paper we define the notion 
of a uniform strategy which is essentially a strategy that 
bids uniformly on all keywords since this type of strategy 
obviates the need to know anything about the particulars 
of the graph and effectively aggregates the click and cost 
functions on the queries it is quite robust and thus 
desirable in practice what is surprising is that uniform strategy 
actually performs well which we will prove 
 
the particulars of the matching rule are determined by 
the internet search company here we treat the function as 
arbitrary 
 our main results and technical overview 
we present positive and negative results for the budget 
optimization problem in particular we show 
 nearly all formulations of the problem are np-hard in 
cases slightly more general than the formulation above where 
the clicks have weights the problem is inapproximable 
better than a factor of − 
e 
 unless p np 
 we give a − e -approximation algorithm for the budget 
optimization problem the strategy found by the algorithm 
is a two-bid uniform strategy which means that it 
randomizes between bidding some value b on all keywords and 
bidding some other value b on all keywords until the budget is 
exhausted 
 we show that this approximation ratio is tight 
for uniform strategies we also give a -approximation 
algorithm that offers a single-bid uniform strategy only 
using one value b this is tight for single-bid uniform 
strategies these strategies can be computed in time nearly linear 
in q k the input size 
uniform strategies may appear to be naive in first 
consideration because the keywords vary significantly in their 
click and cost functions and there may be complex 
interaction between them when multiple keywords are relevant to 
a query after all the optimum can configure arbitrary bids 
on each of the keywords even for the simple case when the 
graph is a matching the optimal algorithm involves 
placing different bids on different keywords via a knapsack-like 
packing section so it might be surprising that a simple 
two-bid uniform strategy is or more effective compared 
to the optimum in fact our proof is stronger showing that 
this strategy is effective against a strictly more 
powerful adversary who can bid independently on the individual 
queries i e not be constrained by the interaction imposed 
by the graph g 
our proof of the − e approximation ratio relies on an 
adversarial analysis we define a factor-revealing lp 
 section where primal solutions correspond to possible 
instances and dual solutions correspond to distributions over 
bidding strategies by deriving the optimal solution to this 
lp we obtain both the proof of the approximation ratio 
and a tight worst-case instance 
we have conducted simulations using real auction data 
from google the results of these simulations which are 
highlighted at the end of section suggest that uniform 
bidding strategies could be useful in practice however 
important questions remain about among other things 
alternate bidding goals on-line or stochastic bidding models 
and game-theoretic concerns which we briefly discuss in 
section 
 modeling a keyword auction 
we describe an auction from an advertiser s point of view 
an advertiser bids on a keyword which we can think of as 
a word or set of words users of the search engine submit 
queries if the query matches a keyword that has been 
bid on by an advertiser then the advertiser is entered into 
an auction for the available ad slots on the results page 
what constitutes a match varies depending on the search 
engine 
 
this type of strategy can also be interpreted as bidding one 
value on all keywords for part of the day and a different 
value for the rest of the day 
 
an advertiser makes a single bid for a keyword that 
remains in effect for a period of time say one day the 
keyword could match many different user queries throughout 
the day each user query might have a different set of 
advertisers competing for clicks the advertiser could also bid 
different amounts on multiple keywords each matching a 
 possibly overlapping set of user queries 
the ultimate goal of an advertiser is to maximize traffic 
to their website given a certain advertising budget we 
now formalize a model of keyword bidding and define an 
optimization problem that captures this goal 
 landscapes 
we begin by considering the case of a single keyword that 
matches a single user query in this section we define the 
notion of a query landscape that describes the relationship 
between the advertiser s bid and what will happen on this 
query as a result of this bid this definition will be central 
to the discussion as we continue to more general cases 
 positions bids and click-through rate 
the search results page for a query contains p possible 
positions in which our ad can appear we denote the highest 
 most favorable position by and lowest by p 
associated with each position i is a value α i that denotes 
the click-through rate ctr of the ad in position i the ctr is 
a measure of how likely it is that our ad will receive a click 
if placed in position i the ctr can be measured empirically 
using past history we assume throughout this work that 
that α i ≤ α j if j i that is higher positions receive at 
least as many clicks as lower positions 
in order to place an ad on this page we must enter the 
auction that is carried out among all advertisers that have 
submitted a bid on a keyword that matches the user s query 
we will refer to such an auction as a query auction to 
emphasize that there is an auction for each query rather than 
for each keyword we assume that the auction is a 
generalized second price gsp auction the advertisers 
are ranked in decreasing order of bid and each advertiser is 
assigned a price equal to the amount bid by the advertiser 
below them in the ranking 
in sponsored search auctions 
this advertiser pays only if the user actually clicks on the ad 
let b b p denote the bids of the top p advertisers in 
this query auction for notational convenience we assume 
that b ∞ and b p α p since the auction is 
a generalized second price auction higher bids win higher 
positions i e b i ≥ b i suppose that we bid b on some 
keyword that matches the user s query then our position is 
defined by the largest b i that is at most b that is 
pos b arg max 
i 
 b i b i ≤ b 
since we only pay if the user clicks and that happens with 
probability α i our expected cost for winning position i 
 
google yahoo and msn all use some variant of the gsp 
auction in the google auction the advertisers bids are 
multiplied by a quality score before they are ranked our 
results carry over to this case as well which we omit from this 
paper for clarity also other auctions besides gsp have 
been considered e g the vickrey clark groves vcg 
auction each auction mechanism will result in a 
different sort of optimization problem in the conclusion we 
point out that for the vcg auction the bidding 
optimization problem becomes quite easy 
would be cost i α i · b i where i pos b we use 
costq b and clicksq b to denote the expected cost and clicks 
that result from having a bid b that qualifies for a query 
auction q and thus 
costq b α i · b i where i pos b 
clicksq b α i where i pos b 
the following observations about cost and clicks follow 
immediately from the definitions and equations and 
we use r to denote the nonnegative reals 
observation for b ∈ r 
 costq b clicksq b can only take on one of a finite 
set of values vq cost α cost p α p 
 both costq b and clicksq b are non-decreasing 
functions of b also cost-per-click cpc costq b clicksq b 
is non-decreasing in b 
 costq b clicksq b ≤ b 
for bids b b p that correspond to the bids of 
other advertisers we have costq b i clicksq b i b i 
i ∈ p when the context is clear we drop the subscript q 
 query landscapes 
we can summarize the data contained in the functions 
cost b and clicks b as a collection of points in a plot of cost 
vs clicks which we refer to as a landscape for example for 
a query with four slots a landscape might look like table 
bid range cost per click cost clicks 
 ∞ 
 
 
 
 
table a landscape for a query 
it is convenient to represent this data graphically as in 
figure ignore the dashed line for now here we graph 
clicks as a function of cost observe that in this graph the 
cpc cost b clicks b of each point is the reciprocal of the 
slope of the line from the origin to the point since cost b 
clicks b and cost b clicks b are non-decreasing the slope 
of the line from the origin to successive points on the plot 
decreases this condition is slightly weaker than concavity 
suppose we would like to solve the budget optimization 
problem for a single query landscape 
as we increase our 
bid from zero our cost increases and our expected number 
of clicks increases and so we simply submit the highest bid 
such that we remain within our budget 
one problem we see right away is that since there are 
only a finite set of points in this landscape we may not be 
able to target arbitrary budgets efficiently suppose in the 
example from table and figure that we had a budget 
 
of course it is a bit unrealistic to imagine that an advertiser 
would have to worry about a budget if only one user query 
was being considered however one could imagine multiple 
instances of the same query and the problem scales 
 
 
 
 
 
 
 
clicks 
cost 
figure a bid landscape 
of bidding between and uses only 
and so we are under-spending bidding more than is 
not an option since we would then incur a cost of and 
overspend our budget 
 randomized strategies 
to rectify this problem and better utilize our available 
budget we allow randomized bidding strategies let b be 
a distribution on bids b ∈ r now we define cost b 
eb∼b cost b and clicks b eb∼b clicks b graphically 
the possible values of cost b clicks b lie in the convex 
hull of the landscape points this is represented in figure 
by the dashed line 
to find a bid distribution b that maximizes clicks subject 
to a budget we simply draw a vertical line on the plot where 
the cost is equal to the budget and find the highest point 
on this line in the convex hull this point will always be the 
convex combination of at most two original landscape points 
which themselves lie on the convex hull thus given the 
point on the convex hull it is easy to compute a distribution 
on two bids which led to this point summarizing 
lemma if an advertiser is bidding on one keyword 
subject to a budget u then the optimal strategy is to pick a 
convex combination of at most two bids which are at the 
endpoints of the line on the convex hull at the highest point 
for cost u 
there is one subtlety in this formulation given any 
bidding strategy randomized or otherwise the resulting cost 
is itself a random variable representing the expected cost 
thus if our budget constraint is a hard budget we have to 
deal with the difficulties that arise if our strategy would be 
over budget therefore we think of our budget constraint as 
soft that is we only require that our expected cost be less 
than the budget in practice the budget is often an average 
daily budget and thus we don t worry if we exceed it one 
day as long as we are meeting the budget in expectation 
further either the advertiser or the search engine possibly 
both monitor the cost incurred over the day hence the 
advertiser s bid can be changed to zero for part of the day 
so that the budget is not overspent 
thus in the 
remain 
see https adwords google com support bin answer 
py answer for example 
der of this paper we will formulate a budget constraint that 
only needs to be respected in expectation 
 multiple queries a knapsack problem 
as a warm-up we will consider next the case when we 
have a set of queries each which its own landscape we want 
to bid on each query independently subject to our budget 
the resulting optimization problem is a small generalization 
of the fractional knapsack problem and was solved in 
the first step of the algorithm is to take the convex hull 
of each landscape as in figure and remove any 
landscape points not on the convex hull each piecewise linear 
section of the curve represents the incremental number of 
clicks and cost incurred by moving one s bid from one 
particular value to another we regard these pieces as items 
in an instance of fractional knapsack with value equal to 
the incremental number of clicks and size equal to the 
incremental cost more precisely for each piece connecting 
two consecutive bids b and b on the convex hull we 
create a knapsack item with value clicks b − clicks b and 
size cost b − cost b we then emulate the greedy 
algorithm for knapsack sorting by value size cost-per-click 
and choosing greedily until the budget is exhausted 
in this reduction to knapsack we have ignored the fact 
that some of the pieces come from the same landscape and 
cannot be treated independently however since each curve 
is concave the pieces that come from a particular query 
curve are in increasing order of cost-per-click thus from 
each landscape we have chosen for our knapsack a set of 
pieces that form a prefix of the curve 
 keyword interaction 
in reality search advertisers can bid on a large set of 
keywords each of them qualifying for a different possibly 
overlapping set of queries but most search engines do not 
allow an advertiser to appear twice in the same search results 
page 
thus if an advertiser has a bid on two different 
keywords that match the same query this conflict must be 
resolved somehow for example if an advertiser has a bid 
out on the keywords shoes and high-heel then if a user 
issues the query high-heel shoes it will match on two 
different keywords the search engine specifies in advance a 
rule for resolution based on the query the keyword and the 
bid a natural rule is to take the keyword with the highest 
bid which we adopt here but our results apply to other 
resolution rules 
we model the keyword interaction problem using an 
undirected bipartite graph g k ∪ q e where k is a set of 
keywords and q is a set of queries each q ∈ q has an 
associated landscape as defined by costq b and clicksq b an 
edge k q ∈ e means that keyword k matches query q 
the advertiser can control their individual keyword bid 
vector a ∈ r 
 k 
 specifying a bid ak for each keyword k ∈ k 
 for now we do not consider randomized bids but we will 
introduce that shortly given a particular bid vector a 
on the keywords we use the resolution rule of taking the 
maximum to define the effective bid on query q as 
bq a max 
k k q ∈e 
ak 
by submitting a bid vector a the advertiser receives some 
 
see https adwords google com support bin answer 
py answer for example 
 
number of clicks and pays some cost on each keyword we 
use the term spend to denote the total cost similarly we use 
the term traffic to denote the total number of clicks 
spend a 
x 
q∈q 
costq bq a traffic a 
x 
q∈q 
clicksq bq a 
we also allow randomized strategies where an advertiser 
gives a distribution a over bid vectors a ∈ r 
 k 
 the 
resulting spend and traffic are given by 
spend a ea∼a spend a traffic a ea∼a traffic a 
we can now state the problem in its full generality 
budget optimization 
input a budget u a keyword-query graph g k ∪ 
q e and landscapes costq · clicksq · for each q ∈ q 
find a distribution a over bid vectors a ∈ r 
 k 
 such 
that spend a ≤ u and traffic a is maximized 
we conclude this section with a small example to illustrate 
some feature of the budget optimization problem suppose 
you have two keywords k u v and two queries q 
 x y and edges e u x u y v y suppose query 
x has one position with ctr αx 
 and there is one 
bid bx 
 query y has two positions with ctrs αy 
 
αy 
 and bids by 
 and by 
 to get any clicks 
from x an advertiser must bid at least on u however 
because of the structure of the graph if the advertiser sets 
bu to then his effective bid is on both x and y thus he 
must trade-off between getting the clicks from x and getting 
the bargain of a click for that would be possible otherwise 
 uniform bidding strategies 
as we will show in section solving the budget 
optimization problem in its full generality is difficult in 
addition it may be difficult to reason about strategies that 
involve arbitrary distributions over arbitrary bid vectors 
advertisers generally prefer strategies that are easy to 
understand evaluate and use within their larger goals with 
this motivation we look at restricted classes of strategies 
that we can easily compute explain and analyze 
we define a uniform bidding strategy to be a distribution 
a over bid vectors a ∈ r 
 k 
 where each bid vector in the 
distribution is of the form b b b for some real-valued 
bid b in other words each vector in the distribution bids 
the same value on every keyword 
uniform strategies have several advantages first they 
do not depend on the edges of the interaction graph since 
all effective bids on queries are the same thus they are 
effective in the face of limited or noisy information about 
the keyword interaction graph second uniform strategies 
are also independent of the priority rule being used third 
any algorithm that gives an approximation guarantee will 
then be valid for any interaction graph over those keywords 
and queries 
we now show that we can compute the best uniform 
strategy efficiently 
suppose we have a set of queries q where the landscape 
vq for each query q is defined by the set of points vq 
 costq αq costq p αq p we define the set of 
interesting bids iq costq αq costq p αq p let 
i ∪q∈qiq and let n i we can index the points 
in i as b bn in increasing order the ith point in 
our aggregate landscape v is found by summing over the 
queries the cost and clicks associated with bid bi that is 
v ∪n 
i 
p 
q∈q costq bi 
p 
q∈q clicksq bi 
for any possible bid b if we use the aggregate landscape 
just as we would a regular landscape we exactly represent 
the cost and clicks associated with making that bid 
simultaneously on all queries associated with the aggregate 
landscape therefore all the definitions and results of section 
about landscapes can be extended to aggregate landscapes 
and we can apply lemma to compute the best uniform 
strategy using the convex hull of the points in this 
aggregate landscape the running time is dominated by the time 
to compute the convex hull which is o n log n 
the resulting strategy is the convex combination of two 
points on the aggregate landscape define a two-bid strategy 
to be a uniform strategy which puts non-zero weight on at 
most two bid vectors we have shown 
lemma given an instance of budget optimization 
in which there are a total of n points in all the landscapes 
we can find the best uniform strategy in o n log n time 
furthermore this strategy will always be a two-bid strategy 
putting these ideas together we get an o n log n -time 
algorithm for budget optimization where n is the total 
number of landscape points we later show that this is a 
 − 
e 
 -approximation algorithm 
 aggregate all the points from the individual query 
landscapes into a single aggregate landscape 
 find the convex hull of the points in the aggregate 
landscape 
 compute the point on the convex hull for the given 
budget which is the convex combination of two points α 
and β 
 output the strategy which is the appropriate convex 
combination of the uniform bid vectors corresponding to 
α and β 
we will also consider a special case of two-bid strategies 
a single-bid strategy is a uniform strategy which puts 
nonzero weight on at most one non-zero vector i e advertiser 
randomizes between bidding a certain amount b 
on all 
keywords and not bidding at all a single-bid strategy is even 
easier to implement in practice than a two-bid strategy for 
example the search engines often allow advertisers to set a 
maximum daily budget in this case the advertiser would 
simply bid b 
until her budget runs out and the ad serving 
system would remove her from all subsequent auctions until 
the end of the day one could also use an ad scheduling 
tool offered by some search companies 
to implement this 
strategy the best single-bid strategy can also be computed 
easily from the aggregate landscape the optimal strategy 
for a budget u will either be the point x s t cost x is as 
large as possible without exceeding u or a convex 
combination of zero and the point y where cost y is as small as 
possible while larger than u 
 
see https adwords google com support bin answer 
py answer for example 
 
b 
d 
a 
c 
clicks cost cpc 
a 
b 
c 
d 
cpc 
 
 
 
 
total clicks 
figure four queries and their click-price curve 
 approximation algorithms 
in the previous section we proposed using uniform 
strategies and gave an efficient algorithm to compute the best 
such strategy in section we prove that there is always a 
good uniform strategy 
theorem there always exists a uniform bidding 
strategy that is − 
e 
 -optimal furthermore for any 
there exists an instance for which all uniform strategies are 
at most − 
e 
 -optimal 
we introduce the notion of a click-price curve which is 
central to our analysis this definition makes it simple to 
show that there is always a single-bid strategy that is a 
 
 
approximation and this is tight we then build on this to 
prove theorem 
 click-price curves 
consider a set of queries q and for each query q ∈ q 
let clicksq · costq · be the corresponding bid landscape 
consider an adversarial bidder ω with the power to bid 
independently on each query note that this bidder is more 
powerful than an optimal bidder which has to bid on the 
keywords suppose this strategy bids b 
q for each query q 
thus ω achieves traffic cω 
p 
i clicks b 
i and incurs total 
spend uω 
p 
i cost b 
i 
without loss of generality we can assume that ω bids so 
that for each query q the cost per click is equal to b 
q i e 
costq b 
q clicksq b 
q b 
q we may assume this because for 
some query q if costq b 
q clicksq b 
q b 
q we can always 
lower b 
q and without changing the cost and clicks 
to aid our discussion we introduce the notion of a 
clickprice curve an example of which is shown in figure 
which describes the cpc distribution obtained by ω 
formally the curve is a non-decreasing function h cω → 
r defined as h r min c 
p 
q b 
q ≤c clicksq b 
q ≥ r 
another way to construct this curve is to sort the queries in 
increasing order by b 
q costq b 
q clicksq b 
q then make a 
step function where the qth step has height b 
q and width 
clicksq b 
q see figure note that the area of each step is 
costq b 
q the following claim follows immediately 
claim uω 
r cω 
 
h r dr 
suppose we wanted to buy some fraction r cω of the 
traffic that ω is getting the click-price curve says that if 
we bid h r on every keyword and therefore every query 
we get at least r traffic since this bid would ensure that for 
all q such that b 
q ≤ h r we win as many clicks as ω note 
that by bidding h r on every keyword we may actually get 
even more than r traffic since for queries q where b 
q is much 
less than h r we may win more clicks than ω however 
all of these extra clicks still cost at most h r per click 
thus we see that for any r ∈ cω if we bid h r on 
every keyword we receive at least r traffic at a total spend 
of at most h r per click note that by randomizing between 
bidding zero and bidding h r we can receive exactly r 
traffic at a total spend of at most r · h r we summarize 
this discussion in the following lemma 
lemma for any r ∈ cω there exists a single-bid 
strategy that randomizes between bidding h r and bidding 
zero and this strategy receives exactly r traffic with total 
spend at most r · h r 
lemma describes a landscape as a continuous function 
for our lower bounds we will need to show that given any 
continuous function there exists a discrete landscape that 
approximates it arbitrarily well 
lemma for any c u and non-decreasing 
function f c → r such that 
r c 
 
f r dr u and any 
small there exists an instance of budget 
optimization with budget u where the optimal solution achieves 
c clicks at cost u and all uniform bidding strategies 
are convex combinations of single-bid strategies that achieve 
exactly r clicks at cost exactly rf r by bidding f r on all 
keywords 
proof construct an instance as follows let be a 
small number that we will later define in terms of define 
r r r rm c such that ri− ri ≤ ri− 
f ri− ≤ f ri ≤ f ri− and m ≤ c f c this 
is possible by choosing ri s spaced by min f ri −f ri− 
now make a query qi for all i ∈ m with bidders bidding 
h ri h ri h rm and ctrs α α · · · α m− 
i ri −ri− the graph is a matching with one keyword 
per query and so we can imagine the optimal solution as 
bidding on queries the optimal solution will always bid 
exactly h ri on query qi and if it did so on all queries 
it would spend u 
pm 
i ri − ri− h ri define small 
enough so that u u which is always possible since 
u ≤ 
z c 
 
f r dr 
mx 
i 
 ri − ri− h ri − h ri− 
≤ u 
m ≤ u c f c 
note that the only possible bids i e all others have the 
same results as one of these are f r f rm and 
bidding uniformly with f ri results in 
pi 
j ri − ri− ri 
clicks at cost h ri ri 
 a 
 
-approximation algorithm 
using lemma we can now show that there is a uniform 
single-bid strategy that is 
 
-optimal in addition to being an 
interesting result in its own right it also serves as a warm-up 
for our main result 
theorem there always exists a uniform single-bid 
strategy that is 
 
-optimal furthermore for any there 
exists an instance for which all single-bid strategies are at 
most 
 
 -optimal 
 
proof applying lemma with r cω we see that 
there is a strategy that achieves traffic cω with spend 
cω ·h cω now using the fact that h is a non-decreasing 
function combined with claim we have 
 cω h cω ≤ 
z cω 
cω 
h r dr ≤ 
z cω 
 
h r dr uω 
which shows that we spend at most uω we conclude that 
there is a 
 
-optimal single-bid strategy randomizing between 
bidding cω and zero 
for the second part of the theorem we construct a tight 
example using two queries q x y two keywords k 
 u v and edges e u x v y 
fix some α where α ≤ and fix some very small 
 query x has two positions with bids of bx 
 α 
and bx 
 and with identical click-through rates αx 
 
αx 
 α query y has one position with a bid of by 
 α 
and a click-through rate of αy 
 α the budget is u 
 α the optimal solution is to bid on u and therefore 
x and bid α on v and therefore y both with probability 
 this achieves a total of α clicks and spends the budget 
exactly the only useful bids are and α since for 
both queries all other bids are identical in terms of cost and 
clicks to one of those three any single-bid solution that uses 
as its non-zero bid gets at most α clicks bidding α on 
both keywords results in α clicks and total cost thus 
since the budget is u α a single-bid solution 
using α can put weight at most α on the α bid 
this results in at most α α clicks this can be made 
arbitrarily close to α by lowering 
 a − 
e 
 -approximation algorithm 
the key to the proof of theorem is to show that there 
is a distribution over single-bid strategies from lemma 
that obtains at least − 
e 
 cω clicks in order to figure 
out the best distribution we wrote a linear program that 
models the behavior of a player who is trying to maximize 
clicks and an adversary who is trying to create an input 
that is hard for the player then using linear programming 
duality we were able to derive both an optimal strategy 
and a tight instance after solving the lp numerically we 
were also able to see that there is a uniform strategy for 
the player that always obtains − 
e 
 cω clicks and then 
from the solution were easily able to guess the optimal 
distribution this methodology is similar to that used in 
work on factor-revealing lps 
 an lp for the worst-case click-price curve 
consider the adversary s problem of finding a click-price 
curve for which no uniform bidding strategy can achieve 
αcω clicks recall that by lemma we can assume that a 
uniform strategy randomizes between two bids u and v we 
also assume that the uniform strategy uses a convex 
combination of strategies from lemma which we can assume by 
lemma thus to achieve αcω clicks a uniform strategy 
must randomize between bids h u and h v where u ≤ αcω 
and v ≥ αcω call the set of such strategies s given a 
 u v ∈ s the necessary probabilities in order to achieve 
αcω clicks are easily determined and we denote them by 
p u v and p u v respectively note further that the 
advertiser is trying to figure out which of these strategies to 
use and ultimately wants to compute a distribution over 
uniform strategies in the lp she is actually going to 
compute a distribution over pairs of strategies in s which we 
will then interpret as a distribution over strategies 
using this set of uniform strategies as constraints we can 
characterize a set of worst-case click-price curves by the 
constraints 
z cω 
 
h r dr ≤ u 
∀ u v ∈ s p u v uh u p u v vh v ≥ u 
a curve h that satisfies these constraints has the property 
that all uniform strategies that obtain αcω clicks spend 
more than u discretizing this set of inequalities and 
pushing the first constraint into the objective function we get 
the following lp over variables hr representing the curve 
min 
x 
r∈ cω 
· hr s t 
∀ u v ∈ s p u v uhu p u v vhv ≥ u 
in this lp s is defined in the discrete domain as s 
 u v ∈ cω 
 ≤ u ≤ αcω ≤ v ≤ cω 
solving this lp for a particular α if we get an objective 
less than u we know up to some discretization that an 
instance of budget optimization exists that cannot be 
approximated better than α the instance is constructed 
as in the proof of lemma a binary search yields the 
smallest such α where the objective is exactly u 
to obtain a strategy for the advertiser we look at the 
dual constraining the objective to be equal to u in order to 
get the polytope of optimum solutions 
x 
 u v ∈s 
wu v 
∀ u v ∈ s 
x 
v u v ∈s 
p u v · u · wu v ≤ and 
x 
u u v ∈s 
p u v · v · wu v ≤ 
it is straightforward to show that the second set of 
constraints is equivalent to the following 
∀h ∈ rcω 
 
x 
r 
hr u 
x 
 u v ∈s 
wu v p u v · u · hu p u v · v · hv ≤ u 
here the variables can be interpreted as weights on strategies 
in s a point in this polytope represents a convex 
combination over strategies in s with the property that for any 
click-price curve h the cost of the mixed strategy is at most 
u since all strategies in s get at least αcω clicks we 
have a strategy that achieves an α-approximation 
interestingly the equivalence between this polytope and the lp dual 
above shows that there is a mixture over values r ∈ c 
that achieves an α-approximation for any curve h 
after a search for the appropriate α which turned out to 
be − 
e 
 we solved these two lps and came up with the 
plots in figure which reveal not only the right 
approximation ratio but also a picture of the worst-case distribution 
and the approximation-achieving strategy 
from the 
pic 
the parameters u and cω can be set arbitrarily using 
scaling arguments 
 
 
 
c e c 
 
c e c 
figure the worst-case click-price curve and − 
 e -approximate uniform bidding strategy as found 
by linear programming 
tures we were able to quickly guess the optimal strategy 
and worst case example 
 proof of theorem 
by lemma we know that for each r ≤ uω there is a 
strategy that can obtain traffic r at cost r · h r by mixing 
strategies for multiple values of r we construct a uniform 
strategy that is guaranteed to achieve at least −e− 
 
fraction of ω s traffic and remain within budget note that 
the final resulting bid distribution will have some weight 
on the zero bid since the single-bid strategies from lemma 
put some weight on bidding zero 
consider the following probability density function over 
such strategies also depicted in figure 
g r 
j 
 for r cω e 
 r for r ≥ cω e 
note that 
r cω 
 
g r dr 
r cω 
cω e 
 
r 
dr i e g is a 
probability density function the traffic achieved by our strategy is 
equal to 
traffic 
z cω 
 
g r ·r dr 
z cω 
cω e 
 
r 
·r dr 
„ 
 − 
 
e 
 
cω 
the expected total spend of this strategy is at most 
spend 
z cω 
 
g r · rh r dr 
 
z cω 
cω e 
h r dr ≤ 
z cω 
 
h r dr uω 
thus we have shown that there exists a uniform bidding 
strategy that is − 
e 
 -optimal 
we now show that no uniform strategy can do better we 
will prove that for all there exists an instance for which 
all uniform strategies are at most − 
e 
 -optimal 
first we define the following click-price curve over the 
domain 
h r 
 
 
 
 for r e− 
 
e − 
„ 
e − 
 
r 
 
for r ≥ e− 
note that h is non-decreasing and non-negative since the 
curve is over the domain it corresponds to an instance 
where cω note also that 
r 
 
h r dr 
e− 
r 
 e 
e − 
 
r 
dr thus this curve corresponds to an instance where 
uω using lemma we construct an actual instance 
where the best uniform strategies are convex combinations 
of strategies that bid h u and achieve u clicks and u · h u 
cost 
suppose for the sake of contradiction that there exists a 
uniform bidding strategy that achieves α −e− 
traffic on 
this instance by lemma there is always a two-bid optimal 
uniform bidding strategy and so we may assume that the 
strategy achieving α clicks randomizes over two bids to 
achieve α clicks the two bids must be on values h u and 
h v with probabilities pu and pv such that pu pv 
 ≤ u ≤ α ≤ v and puu pvv α 
to calculate the spend of this strategy consider two cases 
if u then we are bidding h v with probability pv α v 
the spend in this case is 
spend pv · v · h v αh v 
αe − α v 
e − 
 
using v ≥ α and then α − 
e 
we get 
spend ≥ 
αe − 
e − 
 
 − e e − 
e − 
 
contradicting the assumption 
we turn to the case u here we have pu v−α 
v−u 
and pv α−u 
v−u 
 note that for r ∈ we have h r ≥ 
 
e− 
 e − 
r 
 thus 
spend ≥ pu · uh u pv · vh v 
 
 v − α ue − α − u ve − 
 v − u e − 
 
αe − 
e − 
 
the final inequality follows from α − 
e 
 thus in both 
cases the spend of our strategy is over the budget of 
 experimental results 
we ran simulations using the data available at google 
which we briefly summarize here we took a large 
advertising campaign and using the set of keywords in the 
campaign computed three different curves see figure for 
three different bidding strategies the x-axis is the 
budget units removed and the y-axis is the number of clicks 
obtained again without units by the optimal bid s under 
each respective strategy query bidding represents our 
 unachievable upper bound ω bidding on each query 
independently the uniform bidding curves represent the 
results of applying our algorithm deterministic uses a 
single bid level while randomized uses a distribution for 
reference we include the lower bound of a e − e fraction 
of the top curve 
the data clearly demonstrate that the best single 
uniform bid obtains almost all the possible clicks in practice 
of course in a more realistic environment without full 
knowledge it is not always possible to find the best such bid so 
further investigation is required to make this approach 
useful however just knowing that there is such a bid available 
should make the on-line versions of the problem simpler 
 hardness results 
by a reduction from vertex cover we can show the 
following proof omitted 
theorem budget optimization is strongly np-hard 
 
query bidding 
uniform bidding randomized 
uniform bidding deterministic 
lower bound 
 
 
 
 
 
 
budget 
clicks 
figure an example with real data 
now suppose we introduce weights on the queries that 
indicate the relative value of a click from the various search 
users formally we have weights wq for all q ∈ q and our 
goal is maximize the total weighted traffic given a budget 
call this the weighted keyword bidding problem 
with this additional generalization we can show hardness 
of approximation via a simple reduction from the maximum 
coverage problem which is known to be − e -hard 
 proof omitted 
theorem the weighted keyword bidding 
problem is hard to approximate to within − e 
 exact algorithms for laminar 
graphs 
if a graph has special structure we can sometimes solve 
the budget optimization problem exactly note that the 
knapsack algorithm in section solves the problem for the 
case when the graph is a simple matching here we 
generalize this to the case when the graph has a laminar structure 
which will allow us to impose a partial ordering on the 
possible bid values and thereby give a pseudopolynomial 
algorithm via dynamic programming 
we first show that to solve the budget optimization 
problem for general graphs optimally in pseudopolynomial 
time it suffices to provide an algorithm that solves the 
deterministic case the proof omitted uses ideas similar to 
observation and lemma 
lemma let i be an input to the budget 
optimization problem and suppose that we find the optimal 
deterministic solution for every possible budget u ≤ u then we 
can find the optimal solution in time o u log u 
a collection s of n sets s s is laminar if for any 
two sets si and sj if si ∩ sj ∅ then either si ⊆ sj or 
sj ⊆ si 
given a keyword interaction graph g we associate a set 
of neighboring queries qk q k q ∈ e with each 
keyword k if this collection of sets if laminar we say that the 
graph has the laminar property note that a laminar 
interaction graph would naturally fall out as a consequence of 
designing a hierarchical keyword set e g shoes 
highheel shoes athletic shoes 
we call a solution deterministic if it consists of one bid 
vector rather than a general distribution over bid vectors 
the following lemma will be useful for giving a structure to 
the optimal solution and will allow dynamic programming 
lemma for keywords i j ∈ k if qi ⊆ qj then there 
exists an optimal deterministic solution to the budget 
optimization problem with ai ≥ aj 
we can view the laminar order as a tree with keyword j as 
a parent of keyword i if qj is the minimal set containing qi 
in this case we say that j is a child of i given a keyword j 
with c children i ic we now need to enumerate over all 
ways to allocate the budget among the children and also over 
all possible minimum bids for the children a complication 
is that a node may have many children and thus a term of 
uc 
would not even be pseudopolynomial we can solve this 
problem by showing that given any laminar ordering there 
is an equivalent one in which each keyword has at most 
children 
lemma let g be a graph with the laminar property 
there exists another graph g with the same optimal solution 
to the budget optimization problem where each node has 
at most two children in the laminar ordering furthermore 
g has at most twice as many nodes as g 
given a graph with at most two children per node we 
define f i b u to be the maximum number of clicks achievable 
by bidding at least b on each of keywords j s t qj ⊆ qi 
 and exactly b on keyword i while spending at most u for 
this definition we use z b u to denote set of allowable bids 
and budgets over children 
z b u b b u u b ≥ b u ≤ u 
b ≥ b u ≤ u u u ≤ u 
given a keyword i and a bid ai compute an incremental 
spend and traffic associated with bidding ai on keyword i 
that is 
ˆt i ai 
x 
q∈qi\qi− 
clicksq ai and 
ˆs i ai 
x 
q∈qi\qi− 
costq ai 
now we define f i b u as 
max 
b b u u 
∈z b u 
j 
f j b u f j b u ˆt i b 
ff 
 
if ˆs i b ≤ u − u − u and i and f i b u 
otherwise 
lemma if the graph g has the laminar property then 
after applying lemma the dynamic programming 
recurrence in finds an optimal deterministic solution to the 
budget optimization problem exactly in o b 
u 
n time 
in addition we can apply lemma to compute the 
optimal randomized solution observe that in the dynamic 
program we have already solved the instance for every 
budget u ≤ u so we can find the randomized solution with no 
additional asymptotic overhead 
 
lemma if the graph g has the laminar property then 
by applying lemma the dynamic programming recurrence 
in and lemma we can find an optimal solution to the 
budget optimization problem in o b 
u 
n time 
the bounds in this section make pessimistic assumptions 
about having to try every budget and every level for many 
problems you only need to choose from a discrete set of 
bid levels e g multiples of one cent doing so yields the 
obvious improvement in the bounds 
 bid optimization under vcg 
the gsp auction is not the only possible auction one 
could use for sponsored search indeed the vcg auction 
and variants offer alternatives with compelling 
game-theoretic properties in this section we argue that 
the budget optimization problem is easy under the vcg 
auction 
for a full definition of vcg and its application to 
sponsored search we refer the reader to for the sake 
of the budget optimization problem we can define vcg by 
just redefining costq b replacing equation 
costq b 
p− 
x 
j i 
 α j − α j · b j where i pos b 
observation still holds and we can construct a landscape 
as before where each landscape point corresponds to a 
particular bid b i 
we claim that in the vcg auction the landscapes are 
convex to see this consider two consecutive positions i i 
the slope of line segment between the points corresponding 
to those two positions is 
cost b i − cost b i 
clicks b i − clicks b i 
 
 α i − α i · b i 
α i − α i 
 b i 
since b i ≥ b i the slopes of the pieces of the 
landscape decrease and we get that the curve is convex 
now consider running the algorithm described in 
section for finding the optimal bids for a set of queries 
in this algorithm we took all the pieces from the landscape 
curves sorted them by incremental cpc then took a prefix 
of those pieces giving us bids for each of the queries but 
the equation above shows that each piece has its 
incremental cpc equal to the bid that achieves it thus in the case of 
vcg the pieces are also sorted by bid hence we can obtain 
any prefix of the pieces via a uniform bid on all the 
keywords we conclude that the best uniform bid is an optimal 
solution to the budget optimization problem 
 concluding remarks 
our algorithmic result presents an intriguing heuristic in 
practice bid a single value b on all keywords at the end of 
the day if the budget is under-spent adjust b to be higher 
if budget is overspent adjust b to be lower else maintain 
b if the scenario does not change from day to day this 
simple strategy will have the same theoretical properties as 
our one-bid strategy and in practice is likely to be much 
better of course the scenario does change however and so 
coming up with a stochastic bidding strategy remains an 
important open direction explored somewhat by 
another interesting generalization is to consider weights 
on the clicks which is a way to model conversions a 
conversion corresponds to an action on the part of the user who 
clicked through to the advertiser site e g a sale or an 
account sign-up finally we have looked at this system as a 
black box returning clicks as a function of bid whereas in 
reality it is a complex repeated game involving multiple 
advertisers in it was shown that when a set of advertisers 
use a strategy similar to the one we suggest here under a 
slightly modified first-price auction the prices approach a 
well-understood market equilibrium 
acknowledgments 
we thank rohit rao zoya svitkina and adam wildavsky 
for helpful discussions 
 references 
 g aggarwal a goel and r motwani truthful 
auctions for pricing search keywords acm 
conference on electronic commerce - 
 g aggarwal j feldman and s muthukrishnan 
bidding to the top vcg and equilibria of 
position-based auctions proc waoa 
 c borgs j chayes o etesami n immorlica k 
jain and m mahdian dynamics of bid optimization 
in online advertisement auctions proc www 
 e clarke multipart pricing of public goods public 
choice - 
 b edelman m ostrovsky and m schwarz internet 
advertising and the generalized second price 
auction selling billions of dollars worth of 
keywords second workshop on sponsored search 
auctions 
 u feige a threshold of ln n for approximating set 
cover th acm symposium on theory of 
computing pp - 
 t groves incentives in teams econometrica 
 - 
 k jain m mahdian e markakis a sabieri and v 
vazirani greedy facility location algorithms 
analyzed using dual fitting with factor-revealing lp 
j acm - 
 w labio m rose s ramaswamy internal 
document google inc may 
 a mehta a saberi u vazirani and v vazirani 
adwords and generalized online matching focs 
 
 s muthukrishnan m p´al and z svitkina 
stochastic models for budget optimization in 
search-based advertising to appear in rd workshop 
on sponsored search auctions www 
 f preparata and m shamos computational 
geometry an introduction springer-verlag new 
york ny 
 p rusmevichientong and d williamson an 
adaptive algorithm for selecting profitable keywords 
for search-based advertising services proc th acm 
conference on electronic commerce - 
 w vickrey counterspeculation auctions and 
competitive-sealed tenders journal of finance 
 - 
 
